<!DOCTYPE html>
<!--
Copyright (c) 2014, CKSource - Frederico Knabben. All rights reserved.
Licensed under the terms of the MIT License (see LICENSE.md).
-->
<html>
<head>
	<meta charset="utf-8">
	<title>Bender Dashboard</title>

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<link rel="stylesheet" href="/css/bootstrap.css">
	<link rel="stylesheet" href="/css/chosen.css">
	<link rel="stylesheet" href="/css/chosen-bootstrap.css">
	<link rel="stylesheet" href="/css/dashboard.css">

	<!--[if lt IE 9]>
	<script type='text/javascript' src="/js/libs/css3-mediaqueries.js"></script>
	<script type='text/javascript' src="/js/libs/html5shiv.min.js"></script>
	<script type='text/javascript' src="/js/libs/es5-shim.min.js"></script>
	<script type='text/javascript' src="/js/libs/respond.min.js"></script>
	<![endif]-->
</head>
<body>
	<div id="context">
		<!-- place for a test iframe -->
	</div>
	<nav class="navbar navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<a class="navbar-brand app-title" href="#">Bender Dashboard</a>
				<p class="navbar-text" id="socket-status"></p>
			</div>
			<div class="navbar-right">
				<a class="btn btn-default navbar-btn btn-sm" href="/capture" title="Capture browser">
					<span class="glyphicon glyphicon-download"></span> Capture browser
				</a>
			</div>
		</div>
		<div class="container">
			<div id="tabs">
				<!-- place for a tab navigation -->
			</div>
			<div id="header" class="header">
				<!-- place for a subpage header -->
			</div>
		</div>
	</nav>
	<div class="container">
		<div id="content" class="content">
			<!-- place for a subpage content -->
		</div>
	</div>
	<div id="modal" class="modal fade">
		<!-- place for a dialog modal -->
	</div>
	<div id="alerts" class="alerts">
		<!-- place for a dialog modal -->
	</div>
	<div class="footer">
		<!-- place for a footer -->
	</div>


	<!-- template for a single tab -->
	<script type="text/html" id="tab">
		<a title="<%= label %>"><%= label %></a>
	</script>


	<!-- template for tests table -->
	<script type="text/html" id="tests">
	<table class="table table-hover tests">
		<thead>
			<tr>
				<th class="col-md-3">ID</th>
				<th class="col-md-2">Group</th>
				<th class="col-md-3">Tags</th>
				<th class="col-md-4">Status</th>
			</tr>
		</thead>
		<tbody>
		</tbody>
	</table>
	</script>


	<!-- template for empty tests table -->
	<script type="text/html" id="no-tests">
	<td colspan="4">No tests found. Check your configuration file</td>
	</script>


	<!-- template for a single test row -->
	<script type="text/html" id="test">
	<td><a href="/<%= id %>" title="<%= id %>"><%= id %></a></td>
	<td><span title="<%= group %>"><%= group %></span></td>
	<td title="<%= tags.join(', ') %>"><%= tags.join(', ') %></td>
	<td><span class="glyphicon"></span><span class="result"><%= result %></span></td>
	</script>


	<!-- template for tests tab header -->
	<script type="text/html" id="test-header">
	<div class="col-md-6">
		<p class="test-status">
			<strong class="passed"><%= passed %></strong> passed /
			<strong class="failed"><%= failed %></strong> failed in
			<strong class="time"><%= timeToText(time) %></strong> -
			<strong class="percent"><%= getPercent(completed, total) %></strong>
		</p>
	</div>
	<div class="col-md-6">
		<div class="form-inline filter-form" role="form">
			<div class="btn-group" data-toggle="buttons">
			  <label class="btn btn-primary btn-sm <%= onlyFailed ? '' : 'active' %>" title="Show all tests">
				<input type="radio" name="show-mode" id="all" <%= onlyFailed ? '' : 'checked' %>> All
			  </label>
			  <label class="btn btn-danger btn-sm <%= onlyFailed ? 'active' : '' %>" title="Show failed tests">
				<input type="radio" name="show-mode" id="failed" <%= onlyFailed ? 'checked' : '' %>> Failed
			  </label>
			</div>

			<div class="form-group input-append btn-group">
				<select data-placeholder="Filter tests..." multiple
				class="tag-filter form-control" <%= running ? 'disabled="disabled"' : '' %>>
					<% _.each(tags, function (tag) { %>
					<option value="<%= tag %>" <%= filter.indexOf(tag) > -1 ? 'selected' : '' %>><%= tag %></option>
					<% }) %>
				</select>
			</div>
			<button type="button" class="btn btn-primary btn-sm run-button">
				<span class="glyphicon glyphicon-<%= running ? 'stop' : 'play' %>"></span>
			</button>
			<button type="button" class="btn btn-primary btn-sm create-button">
				<span class="glyphicon glyphicon-file"></span> Create a job
			</button>
		</div>
	</div>
	</script>


	<!-- template for jobs table -->
	<script type="text/html" id="jobs">
	<table class="table table-hover jobs">
		<thead>
			<tr>
				<th class="col-md-1">ID</th>
				<th class="col-md-2">Description</th>
				<th class="col-md-2">Created</th>
				<th class="col-md-7">Results</th>
			</tr>
		</thead>
		<tbody>
		</tbody>
	</table>
	</script>


	<!-- template for empty jobs table -->
	<script type="text/html" id="no-jobs">
	<td colspan="4" class="empty">No jobs found.</td>
	</script>


	<!-- template for a single job row -->
	<script type="text/html" id="job-row">
	<td><a href="#jobs/<%= id %>"><%= id %></a></td>
	<td><%= description %></td>
	<td><small><%= getTime(created) %></small></td>
	<td class="results">
		<% _.each(results, function (result) { %>
		<div class="browser <%= result.name %> <%= getResultStyle(result) %>">
			<span class="glyphicon <%= getIcon(result) %>"></span>
			<small><%= result.version ? result.version : '-' %></small>
		</div>
		<% }) %>
	</td>
	</script>


	<!-- template for a job details page -->
	<script type="text/html" id="job">
	<div class="row">
		<div class="col-md-6">
			<h4>
				<small>Job:</small> <%= id %> <small>
				<%= created ? 'created ' + getTime(created) : '' %></small>
			</h4>
		</div>
		<div class="col-md-6 text-right">
			<button type="button" class="btn btn-sm btn-primary back-button">
				<span class="glyphicon glyphicon-arrow-left"></span> Back
			</button>
			<button type="button" title="Edit" class="btn btn-sm btn-default edit-button">
				<span class="glyphicon glyphicon-edit"></span>
			</button>
			<button type="button" title="Remove" class="btn btn-sm btn-danger remove-button">
				<span class="glyphicon glyphicon-remove"></span>
			</button>
			<button type="button" title="Restart" class="btn btn-sm btn-success restart-button">
				<span class="glyphicon glyphicon-play"></span>
			</button>
		</div>
	</div>
	<div class="row">
		<div class="col-md-12">
			<h4><small>Description:</small> <%= description ? description : '-' %></h4>
		</div>
	</div>
	<div class="row">
		<div class="col-md-12">
			<h4><small>Filters:</small>
				<% if (filter.length) { _.each(filter, function (item) { %>
					<span class="filter"><%= item %></span>
				<% }) } else { %>
					-
				<% } %>
			</h4>
		</div>
	</div>
	<div class="panel panel-default">
		<table class="table table-hover jobs">
			<thead>
				<tr>
					<th class="col-md-3">Test ID</th>
					<th class="col-md-9 job-browsers">
						<% _.each(browsers, function (browser) { %>
						<div class="browser <%= browser.name %>">
							<small><%= browser.version ? browser.version : '-' %></small>
						</div>
						<% }) %>
					</th>
				</tr>
			</thead>
			<tbody>
			</tbody>
		</table>
	</div>
	</script>

	<!-- template for confirmation modal -->
	<script type="text/html" id="confirm">
	<div class="modal-body"><%= message %></div>
	<div class="modal-footer">
		<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
		<button type="button" class="btn btn-primary submit-button">Confirm</button>
	</div>
	</script>


	<!-- template for a single task row -->
	<script type="text/html" id="task">
		<td><a href="/jobs/<%= jobId %>/tests/<%= id %>" title="<%= id %>"><%= id %></a></td>
		<td class="results">
			<% _.each(results, function (result) { %>
				<div class="result <%= getResultStyle(result) %> <% if (result.errors) { %>clickable<% } %>">
					<span class="glyphicon <%= getIcon(result) %>"></span>
				</div>
			<% }) %>
		</td>
	</script>


	<!-- template for create a job modal -->
	<script type="text/html" id="create-job">
	<div class="modal-header">
		<button type="button" data-dismiss="modal" class="close">&times;</button>
		<h4 class="modal-title">Create a job</h4>
	</div>
	<div class="modal-body">
		<div class="form-group input-append btn-group job-browsers-group">
			<label for="job-browsers">Browsers</label>
			<input type="text" id="job-browsers" class="form-control" name="job-browsers" data-toggle="dropdown" placeholder="Choose browsers e.g. Chrome Firefox IE9 Safari" value="<%= browsers.join(' ') %>">
			<ul class="dropdown-menu">
				<% _.each(App.Browsers.browsersList.models, function (browser) { %>
					<% if (browser.attributes.header) { %><li><a><%= browser.id %></a></li><% } %>
				<% }) %>
			</ul>
		</div>
		<div class="form-group">
			<label for="job-description">Job description <span>(optional)</span></label>
			<input type="text" id="job-description" class="form-control" name="job-description" placeholder="Enter job description" value="<%= description %>">
		</div>
		<div class="form-group filters">
			<p><strong>Filters</strong></p>
			<p class="filters">
				<% if (filter.length) { _.each(filter, function (item) { %>
					<span class="filter"><%= item %></span>
				<% }) } else { %>
					none
				<% } %>
			</p>
		</div>
	</div>
	<div class="modal-footer">
		<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
		<button type="button" class="btn btn-primary create-button">
			Create <span class="loader"></span>
		</button>
	</div>
	</script>


	<!-- template for task errors modal -->
	<script type="text/html" id="task-errors">
	<div class="modal-header">
		<button type="button" data-dismiss="modal" class="close">&times;</button>
		<h4 class="modal-title">Error details for <%= id %></h4>
	</div>
	<div class="modal-body">
	<% _.each(errors, function (error) { %>
		<p>
			<strong><%= error.name %></strong><br>
			<pre><%- error.error %></pre>
		</p>
	<% }) %>
	</div>
	<div class="modal-footer">
		<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	</div>
	</script>


	<!-- template for browsers table -->
	<script type="text/html" id="browsers">
	<table class="table table-hover table-condensed browsers">
		<thead>
			<tr>
				<th class="col-md-2">Browser</th>
				<th class="col-md-4">ID</th>
				<th class="col-md-3">UA</th>
				<th class="col-md-2">Address</th>
				<th class="col-md-1">Status</th>
			</tr>
		</thead>
		<tbody>
		</tbody>
	</table>
	</script>


	<!-- template for empty browsers table -->
	<script type="text/html" id="no-browsers">
	<td colspan="5">No browsers found. Check your configuration file</td>
	</script>


	<!-- template for a single browser row -->
	<script type="text/html" id="browser">
	<% if (header) { %>
		<th class="browser <%= name %>"><%= id %></th>
		<th colspan="4"></th>
	<% } else { %>
		<td></td>
		<td><%= id %></td>
		<td><%= ua %></td>
		<td><%= addr %></td>
		<td>
			<span class="label label-<%= ready ? 'success' : 'warning' %>">
				<%= ready ? 'ready' : 'busy' %>
			</span>
		</td>
	<% } %>
	</script>


	<!-- template for error 404 page -->
	<script type="text/html" id="error404">
	<h4>Error 404</h4>
	<h5>Page not found</h5>
	</script>


	<!-- template for unknown error page -->
	<script type="text/html" id="error">
	<h4>Error</h4>
	<h5>Unknown error occured</h5>
	</script>


	<!-- template for an alert -->
	<script type="text/html" id="alert">
	<strong><%= title %></strong> <%= message %>
	</script>


	<script src="/socket.io/socket.io.js"></script>

	<script src="/js/libs/jquery-1.10.2.js"></script>
	<script src="/js/libs/underscore.js"></script>
	<script src="/js/libs/moment.min.js"></script>
	<script src="/js/libs/backbone.js"></script>
	<script src="/js/libs/backbone.marionette.js"></script>
	<script src="/js/libs/bootstrap.js"></script>
	<script src="/js/libs/chosen.jquery.js"></script>

	<script src="/js/bender-config.js"></script>
	<script src="/js/bender.js"></script>

	<script src="/js/main.js"></script>
	<script src="/js/common.js"></script>
	<script src="/js/tabs.js"></script>
	<script src="/js/alerts.js"></script>
	<script src="/js/sockets.js"></script>
	<script src="/js/tests.js"></script>
	<script src="/js/jobs.js"></script>
	<script src="/js/browsers.js"></script>

	<script>
		$(function () {
			App.start();
		});
	</script>
</body>
</html>
