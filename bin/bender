#!/usr/bin/env node

/**
 * Copyright (c) 2014, CKSource - Frederico Knabben. All rights reserved.
 * Licensed under the terms of the MIT License (see LICENSE.md).
 *
 * @file Bender executable
 */

'use strict';

var argParser = require( 'nomnom' ),
	dir = '../lib/',
	constants = require( dir + 'constants' ),
	cli = require( dir + 'cli' );

argParser.script( 'bender' );

argParser.command( 'init' )
	.callback( cli.initialize )
	.help( 'Initialize Bender.js for this directory' );

argParser.command( 'clean' )
	.callback( cli.clean )
	.help( 'Clean all Bender.js local files except the configuration' );

argParser.command( 'server' )
	.callback( cli.handleServer )
	.option( 'port', {
		abbr: 'p',
		help: 'Port on which the server will run'
	} )
	.option( 'hostname', {
		abbr: 'H', // YEAH... should be "h" but it's reserved for nomnom's help
		help: 'Hostname used to run server'
	} )
	.option( 'config', {
		abbr: 'c',
		default: constants.CONFIG_NAME,
		help: 'Alternative path to Bender.js configuration file'
	} )
	.help( 'Start Bender.js server' );

argParser.command( 'version' )
	.callback( function() {
		console.log( 'Bender.js v%s', constants.VERSION );
	} )
	.help( 'Print Bender.js version' );

argParser.command( 'run' )
	.callback( cli.runTests )
	.option( 'port', {
		abbr: 'p',
		help: 'Port on which the server will run'
	} )
	.option( 'hostname', {
		abbr: 'H', // YEAH... should be "h" but it's reserved for nomnom's help
		help: 'Hostname used to run server'
	} )
	.option( 'config', {
		abbr: 'c',
		default: constants.CONFIG_NAME,
		help: 'Alternative path to Bender.js configuration file'
	} )
	.option( 'browser', {
		abbr: 'b',
		help: 'Browser to run the tests on'
	} )
	.help( 'Run the tests in a browser and output the results to the console' );

argParser.parse();
